Dribbble.FollowBar={currentRecs:[],followBarTracked:[],maxSlots:8,initialize:function(){this.trackRecommendationsViewed()},addContext:function(e){var t=e.querySelector(".follow"),o=t.getAttribute("href");t.setAttribute("href",o+"?follow_bar=true")},bindEventListeners:function(){document.querySelectorAll(".follow-prompt .follow").forEach(function(e){e.addEventListener("click",function(){Dribbble.FollowBar.trackFollow(e)})}),document.querySelectorAll(".profile-name, .profile-photo, .user-card-shots").forEach(function(e){e.addEventListener("click",function(){Dribbble.FollowBar.trackSuggestionClick(e)})})},findCurrentRecommendations:function(e){var t=e.nextElementSibling,o=t.classList.contains("suggested-follow");return this.currentRecs.length<=8&&o&&(this.currentRecs.push(t.firstElementChild),this.findCurrentRecommendations(t)),this.currentRecs},resetCurrentRecommendations:function(){this.currentRecs=[]},setSlotType:function(e,t,o){if(slotRanges=["250","250-500","500-1000","1000-2000"],o<=4)e.setAttribute("data-slot-type",slotRanges[t]);else{var r=o-slotRanges.length,n=slotRanges;slotRanges.slice(0,r).forEach(function(e){var t=n.lastIndexOf(e);n.splice(t,0,e)}),e.setAttribute("data-slot-type",n[t])}},setSegmentOptions:function(e,t){var n={page:document.querySelectorAll(".dribbble-shot").length/24,recommendations_shown:t};return e.forEach(function(e,t){if(0!=e.offsetWidth&&t<Dribbble.FollowBar.maxSlots){var o=e.getAttribute("data-user-id"),r=e.getAttribute("data-slot-type");n["recommendation_"+(t+1)]=o,n["recommendation_"+(t+1)+"_slot"]=r}}),n},trackFollow:function(e){var t=e.closest(".user-card").getAttribute("data-user-id"),o=e.closest(".user-card").getAttribute("data-slot-type");Dribbble.Segment.track("designer_recommendation_taken",{recommended_designer_id:t,recommendation_slot:o})},trackRecommendationsViewed:function(){$(window).on("scroll",function(){var e=$(".follow-feed-separator").last();if(0<e.length&&(e.first().offset().top+e.first().outerHeight()-$(window).height()<$(this).scrollTop()&&Dribbble.FollowBar.followBarTracked.length<$(".follow-feed-separator").length)){var t=[],o=document.querySelectorAll(".follow-feed-separator"),r=o[o.length-1],n=Dribbble.FollowBar.findCurrentRecommendations(r);n.forEach(function(e){0===e.offsetWidth&&t.push(e)});var l=n.length-t.length;n.forEach(function(e){0!=e.offsetWidth&&(Dribbble.FollowBar.setSlotType(e,e.getAttribute("data-slot-index"),l),Dribbble.FollowBar.addContext(e))});var i=Dribbble.FollowBar.setSegmentOptions(n,l);Dribbble.Segment.track("designer_recommendation_viewed",i),Dribbble.FollowBar.bindEventListeners(),Dribbble.FollowBar.followBarTracked.push("1"),Dribbble.FollowBar.resetCurrentRecommendations()}})},trackSuggestionClick:function(e){var o={},t=e.closest(".user-card").getAttribute("data-user-id"),r=e.closest(".user-card").getAttribute("data-slot-type");e.parentNode.parentNode.querySelectorAll(".recommendation-skill").forEach(function(e,t){o["skill_"+(t+1)]=e.innerText}),Dribbble.Segment.track("designer_recommendation_clicked",{recommended_designer_id:t,recommendation_slot:r,skills:o})}},Dribbble.FollowBar.initialize();